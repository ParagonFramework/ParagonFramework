<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no">
    <meta charset="utf-8">
    <title>Geographic Polygon</title>
    <style type="text/css">
        html, body, #map-canvas { height: 100%; margin: 0; padding: 0; }
        #map-canvas { width: 800px; height: 500px; }
    </style>
    <script type="text/javascript"
            src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCd8mtg8rMF11DeChi_A-U4JhCCjfLMkkw"></script>
    <script type="text/javascript">
        var polygon;
        var map;
        var formid;
        var groupids = new Array();

        function initialize() {
            var coords = [
                new google.maps.LatLng(0, 0),
                new google.maps.LatLng(18.466, -66.118),
                new google.maps.LatLng(32.321, -64.757)
            ];
            var mapOptions = {
                center: new google.maps.LatLng(0, 0),
                zoom: 8
            };
            map = new google.maps.Map(document.getElementById('map-canvas'), mapOptions);

            polygon = new google.maps.Polygon({
                paths: coords,
                geodesic: true,
                editable: true,
                map: map
            });

            addPolygonListeners();
            google.maps.event.addListener(polygon, 'click', updateCoordinates);
        }

        function generateUUID() {
            return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {
                var r = Math.random()*16|0, v = c == 'x' ? r : (r&0x3|0x8);
                return v.toString(16);
            });
        }

        function addPolygonListeners() {
            google.maps.event.addListener(polygon.getPath(), 'set_at', function() {
                updateCoordinates();
            });

            google.maps.event.addListener(polygon.getPath(), 'insert_at', function() {
                addCoordinate();
                updateCoordinates();
            });

            google.maps.event.addListener(polygon.getPath(), 'remove_at', function() {
                removeCoordinate(groupids[groupids.length - 1]);
                updateCoordinates();
            });
        }

        function updateCoordinates() {
            var coords = polygon.getPath();
            coords.forEach(function(latlng, i) {
                document.getElementById(groupids[i] + '-lat').value = latlng.lat();
                document.getElementById(groupids[i] + '-lng').value = latlng.lng();
            });
        }

        function getCoordinates() {
            var coords = new Array();
            for (var i = 0; i < groupids.length; ++i) {
                coords.push(new google.maps.LatLng(
                    document.getElementById(groupids[i] + '-lat').value,
                    document.getElementById(groupids[i] + '-lng').value
                ));
            }
            polygon.setPaths(coords);
            addPolygonListeners();
        }

        function addCoordinate() {
            var uuid = generateUUID();
            groupids.push(uuid);
            var form = document.getElementById('map-coord');
            var latlnggroup = document.createElement('div');
            latlnggroup.setAttribute('class', 'form-group');
            latlnggroup.setAttribute('name', uuid);
            latlnggroup.setAttribute('id', uuid);
            var latlabel = document.createElement('label');
            latlabel.innerHTML = 'Latitude';
            var latinput = document.createElement('input');
            latinput.setAttribute('class', 'form-control');
            latinput.setAttribute('type', 'text');
            latinput.setAttribute('name', uuid + '-lat');
            latinput.setAttribute('id', uuid + '-lat');
            var lnglabel = document.createElement('label');
            lnglabel.innerHTML = 'Langitude';
            var lnginput = document.createElement('input');
            lnginput.setAttribute('class', 'form-control');
            lnginput.setAttribute('type', 'text');
            lnginput.setAttribute('name', uuid + '-lng');
            lnginput.setAttribute('id', uuid + '-lng');
            var removebtn = document.createElement('button');
            removebtn.setAttribute('class', 'btn btn-default');
            removebtn.setAttribute('onclick', 'removeCoordinate("' + uuid + '"); return false;');
            removebtn.innerHTML = 'Remove';
            latlnggroup.appendChild(latlabel);
            latlnggroup.appendChild(latinput);
            latlnggroup.appendChild(lnglabel);
            latlnggroup.appendChild(lnginput);
            latlnggroup.appendChild(removebtn);
            form.appendChild(latlnggroup);
        }

        function removeCoordinate(uuid) {
            var index = groupids.indexOf(uuid);
            if (index > -1) groupids.splice(index, 1);
            var group = document.getElementById(uuid);
            group.parentNode.removeChild(group);
            getCoordinates();
        }

        google.maps.event.addDomListener(window, 'load', initialize);
    </script>
</head>
<body>
<div id="map-canvas"></div>
<form role="form" id="map-form">
    <div id="map-coord"></div>
    <div class="form-group">
        <button class="btn btn-default" id="addbtn" onclick="addCoordinate(); return false;">Add Coordinate</button>
        <button class="btn btn-default" id="okbtn" onclick="getCoordinates(); return false;">OK</button>
    </div>
</form>
</body>
</html>